<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alt Nivel Studio</title>
  <link rel="stylesheet" href="style.css">
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</head>
<body>
  <div id="app"></div>

  <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    async function loadContent() {
      try {
        const res = await fetch('content.md');
        const text = await res.text();

        // Parse frontmatter
        const match = text.match(/^---\n([\s\S]*?)\n---\n([\s\S]*)$/);
        if (!match) {
          console.error('Could not parse frontmatter');
          return;
        }
        const meta = jsyaml.load(match[1]);
        const markdown = match[2];

        console.log('Parsed meta:', meta);

      // Parse markdown sections
      const sections = {};
      let currentSection = 'intro';
      markdown.split('\n').forEach(line => {
        if (line.startsWith('## ')) {
          currentSection = line.replace('## ', '').toLowerCase()
            .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
            .replace(/[^a-z0-9]+/g, '_');
        }
        sections[currentSection] = (sections[currentSection] || '') + line + '\n';
      });

      // Update title
      document.title = `${meta.title} - Alt Nivel Studio`;

      // Render
      document.getElementById('app').innerHTML = `
        <header class="hero">
          <div class="container">
            <h1>${meta.title}</h1>
            <p class="subtitle">${meta.subtitle || ''}</p>
          </div>
        </header>

        <main>
          <section class="intro">
            <div class="container">
              <h2>${meta.sections?.intro?.title || 'Despre ce e vorba?'}</h2>
              ${marked.parse(sections.despre_ce_e_vorba_ || sections.intro || '')}
            </div>
          </section>

          <section class="format">
            <div class="container">
              <h2>${meta.sections?.format?.title || 'Formatul'}</h2>
              <ul class="format-list">
                ${(meta.format || []).map(item => `
                  <li>
                    <ion-icon name="${item.icon}"></ion-icon>
                    <span>${item.text}</span>
                  </li>
                `).join('')}
              </ul>
            </div>
          </section>

          <section class="package">
            <div class="container">
              <h2>${meta.sections?.package?.title || 'Ce primesti'}</h2>
              <div class="package-card">
                <div class="price">
                  <span class="amount">${meta.price?.amount || ''}</span>
                  <span class="currency">${meta.price?.currency || ''}</span>
                  <span class="note">${meta.price?.note || ''}</span>
                </div>
                <ul class="deliverables">
                  ${(meta.deliverables || []).map(item => `
                    <li>
                      <ion-icon name="checkmark-circle-outline"></ion-icon>
                      <span>${item}</span>
                    </li>
                  `).join('')}
                </ul>
                <p class="payment-terms">
                  <ion-icon name="information-circle-outline"></ion-icon>
                  ${meta.payment_terms || ''}
                </p>
              </div>
            </div>
          </section>

          <section class="team">
            <div class="container">
              <h2>Echipa</h2>
              <div class="team-grid">
                ${(meta.team || []).map(m => `
                  <div class="team-member">
                    <h3>${m.name}</h3>
                    <p>${m.role}</p>
                  </div>
                `).join('')}
              </div>
            </div>
          </section>

          <section class="ideal-for">
            <div class="container">
              <h2>${meta.sections?.ideal_for?.title || 'Pentru cine e acest format?'}</h2>
              <ul class="ideal-list">
                ${(meta.ideal_for || []).map(item => `<li>${item}</li>`).join('')}
              </ul>
            </div>
          </section>

          <section class="cta">
            <div class="container">
              <h2>Rezerva-ti locul</h2>
              <p>${meta.cta_subtitle || 'Locuri limitate - doar 5 spoturi disponibile per editie'}</p>
              <form class="reservation-form" id="reservationForm">
                <div class="form-row">
                  ${(meta.form_fields || []).slice(0, 2).map(f => `
                    <div class="form-group">
                      <label for="${f.name}">${f.label}</label>
                      <input type="${f.type}" id="${f.name}" name="${f.name}" ${f.required ? 'required' : ''}>
                    </div>
                  `).join('')}
                </div>
                <div class="form-row">
                  ${(meta.form_fields || []).slice(2, 4).map(f => `
                    <div class="form-group">
                      <label for="${f.name}">${f.label}</label>
                      <input type="${f.type}" id="${f.name}" name="${f.name}" ${f.required ? 'required' : ''}>
                    </div>
                  `).join('')}
                </div>
                ${(meta.form_fields || []).slice(4).map(f => `
                  <div class="form-group">
                    <label for="${f.name}">${f.label}</label>
                    ${f.type === 'textarea'
                      ? `<textarea id="${f.name}" name="${f.name}" rows="4" ${f.required ? 'required' : ''}></textarea>`
                      : `<input type="${f.type}" id="${f.name}" name="${f.name}" ${f.required ? 'required' : ''}>`
                    }
                  </div>
                `).join('')}
                <button type="submit" class="submit-btn">
                  <ion-icon name="send-outline"></ion-icon>
                  Trimite cererea
                </button>
              </form>
            </div>
          </section>
        </main>

        <footer>
          <div class="container">
            <p>Alt Nivel Studio - Doua etaje mai sus, infinit la creativitate</p>
            <div class="footer-links">
              <a href="https://www.altnivel.studio" target="_blank">
                <ion-icon name="globe-outline"></ion-icon>
                altnivel.studio
              </a>
              <a href="mailto:hello@altnivel.studio">
                <ion-icon name="mail-outline"></ion-icon>
                hello@altnivel.studio
              </a>
            </div>
          </div>
        </footer>
      `;
      } catch (err) {
        console.error('Error loading content:', err);
        document.getElementById('app').innerHTML = '<p>Error loading content. Check console.</p>';
      }
    }

    loadContent();
  </script>
</body>
</html>
